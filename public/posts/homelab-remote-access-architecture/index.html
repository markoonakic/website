











    
        
    

    
        

        
            
        
    
        

        
            
        
    



















<!doctype html>
<html    lang="en-us" >
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta content="Marko Nakić" name="apple-mobile-web-app-title">

    

    

    
        <meta content="Architecture, Homelab, Kubernetes, Traefik" name="keywords">
    

    <meta content="#df4655" name="theme-color">
    <meta content="width=device-width, initial-scale=1" name="viewport">

    
        <title>Homelab Remote Access Architecture · Posts · Marko Nakić</title>
    

    <meta property="og:url" content="http://localhost:1313/posts/homelab-remote-access-architecture/">
  <meta property="og:site_name" content="Marko Nakić">
  <meta property="og:title" content="Homelab Remote Access Architecture">
  <meta property="og:description" content="This post explains how I remotely access my Kubernetes homelab cluster through a secure architecture using Traefik, MetalLB, and cert-manager.
Architecture Overview Traffic Flow All external traffic follows the same path through the ingress layer:
Internet → Router: All requests (HTTP/HTTPS on 80/443 and Headscale DERP on 3478) arrive at the home router
Router → MetalLB: Port forwarding sends all traffic to the MetalLB virtual IP (192.168.0.220)
MetalLB → Traefik: MetalLB load balancer distributes traffic to Traefik service across both cluster nodes">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-12-05T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-12-05T00:00:00+00:00">
    <meta property="article:tag" content="Homelab">
    <meta property="article:tag" content="Kubernetes">
    <meta property="article:tag" content="Traefik">
    <meta property="article:tag" content="Architecture">

    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Homelab Remote Access Architecture">
  <meta name="twitter:description" content="This post explains how I remotely access my Kubernetes homelab cluster through a secure architecture using Traefik, MetalLB, and cert-manager.
Architecture Overview Traffic Flow All external traffic follows the same path through the ingress layer:
Internet → Router: All requests (HTTP/HTTPS on 80/443 and Headscale DERP on 3478) arrive at the home router
Router → MetalLB: Port forwarding sends all traffic to the MetalLB virtual IP (192.168.0.220)
MetalLB → Traefik: MetalLB load balancer distributes traffic to Traefik service across both cluster nodes">


    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <link rel="alternate icon" href="/favicon.ico" type="image/x-icon">

    

    

    

    

    

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

    

    <link rel="stylesheet" href="/css/syntax.css">
<link rel="stylesheet" href="/css/custom.css">
<link rel="stylesheet" href="/css/mermaid.css">

</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col mt-3" id="site" >
                












    





    



    <header id="site-header">
        
            <div class="header-flex-container">
                
                    <div class="display-1 fw-bold text-center text-md-start" id="site-title">
                        <a class="text-body text-decoration-none" href="/">Marko Nakić</a>
                    </div>
                

                
                    <nav aria-label="" id="site-menu">
                        <ul class="align-items-center justify-content-center justify-content-md-end nav ">
                        
                            

                            
                            
                            

                            

                            <li class="nav-item ">
                                <a   class="  nav-link  "  href="/about/"    >About</a>

                                
                            </li>
                        
                            

                            
                            
                            

                            

                            <li class="nav-item ">
                                <a   class="  nav-link  "  href="/index/"    >Index</a>

                                
                            </li>
                        
                            

                            
                            
                            

                            

                            <li class="nav-item ">
                                <a   class="  nav-link  "  href="/tags/"    >Tags</a>

                                
                            </li>
                        
                            

                            
                            
                            

                            

                            <li class="nav-item ">
                                <a   class="  nav-link  "  href="/search/"    ><i class="bi bi-search"></i></a>

                                
                            </li>
                        
                        </ul>
                    </nav>
                
            </div>
        

        

        
    </header>


                




















    



    
        
    










<article class=" align-items-center d-flex flex-column  kind-page status-published" id="page">
    






    
        
        
        
        
        
        
            
        
    












    









    <header class="mw-100 text-center" id="page-header">

        
            <div class="d-flex align-items-center justify-content-center gap-3 mb-4" id="page-title-container">
                
                    <h1 class="fw-bold mb-0" id="page-title" >Homelab Remote Access Architecture</h1>
                
                
            </div>
        

        

        
            <div>
                
                    <p class=" row-short   text-secondary " id="page-keywords">
                        
                            

                            
                                
                            

                            
                                
                                
                                    <a class="link-secondary page-keyword-tag" href="/tags/architecture/" >Architecture</a>
                                
                            
                        
                            

                            
                                
                            

                            
                                <span class="meta-separator">·</span>
                                
                                    <a class="link-secondary page-keyword-tag" href="/tags/homelab/" >Homelab</a>
                                
                            
                        
                            

                            
                                
                            

                            
                                <span class="meta-separator">·</span>
                                
                                    <a class="link-secondary page-keyword-tag" href="/tags/kubernetes/" >Kubernetes</a>
                                
                            
                        
                            

                            
                                
                            

                            
                                <span class="meta-separator">·</span>
                                
                                    <a class="link-secondary page-keyword-tag" href="/tags/traefik/" >Traefik</a>
                                
                            
                        
                    </p>
                

                

                

                
                    <p class="row-short text-secondary" id="page-date">
                        <time datetime="2025-12-05" >December 5, 2025</time>
                        <span class="meta-separator">·</span>
                        <span>Marko Nakić</span>
                    </p>
                
            </div>
        

        

        
            <div class="align-items-center d-flex flex-column row-tall text-center" id="page-toc">
                <details class="toc-collapsible">
                    <summary class="toc-summary">Table of Contents</summary>
                    <div class="toc-anim-wrapper">
                        <div class="toc-content">
                            <nav id="TableOfContents">
  <ul>
    <li><a href="#architecture-overview">Architecture Overview</a></li>
    <li><a href="#traffic-flow">Traffic Flow</a></li>
    <li><a href="#certificate-management">Certificate Management</a></li>
    <li><a href="#headscale-integration">Headscale Integration</a></li>
    <li><a href="#infrastructure">Infrastructure</a></li>
  </ul>
</nav>
                        </div>
                    </div>
                </details>
            </div>
        

    </header>



    
        <main class="mw-100" id="page-content" >
                <p>This post explains how I remotely access my Kubernetes homelab cluster through a secure architecture using Traefik, MetalLB, and cert-manager.</p>
















<h2 id="architecture-overview">Architecture Overview</h2>
<img src="/diagrams/remote-access-architecture.excalidraw.svg">
















<h2 id="traffic-flow">Traffic Flow</h2>
<p>All external traffic follows the same path through the ingress layer:</p>
<ol>
<li>
<p><strong>Internet → Router</strong>: All requests (HTTP/HTTPS on 80/443 and Headscale DERP on 3478) arrive at the home router</p>
</li>
<li>
<p><strong>Router → MetalLB</strong>: Port forwarding sends all traffic to the MetalLB virtual IP (192.168.0.220)</p>
</li>
<li>
<p><strong>MetalLB → Traefik</strong>: MetalLB load balancer distributes traffic to Traefik service across both cluster nodes</p>
</li>
<li>
<p><strong>Traefik → Ingress Resources</strong>: Traefik reads Kubernetes Ingress resources and routes based on hostname:</p>
<ul>
<li><code>grafana.sarma.love</code> → Grafana service in monitoring namespace</li>
<li><code>headscale.sarma.love</code> → Headscale/Headplane services in headscale namespace</li>
<li><code>glance.sarma.love</code> → Glance dashboard in dashboard namespace</li>
</ul>
</li>
</ol>
















<h2 id="certificate-management">Certificate Management</h2>
<p>TLS certificates are automatically managed through a DNS-01 challenge workflow:</p>
<ol>
<li>
<p><strong>cert-manager</strong> obtains a wildcard certificate (<code>*.sarma.love</code>) from Let&rsquo;s Encrypt using DNS-01 validation</p>
</li>
<li>
<p><strong>Reflector</strong> automatically syncs the <code>sarma-wildcard-tls</code> secret to all namespaces that need it (monitoring, headscale, dashboard)</p>
</li>
<li>
<p><strong>Traefik</strong> terminates TLS connections using these synced certificates from each namespace&rsquo;s Ingress resource</p>
</li>
</ol>
















<h2 id="headscale-integration">Headscale Integration</h2>
<p>Headscale runs inside the cluster as a self-hosted Tailscale control server. Unlike typical setups, it doesn&rsquo;t receive direct port forwarding—instead, all traffic (including DERP relay on port 3478) flows through the same Traefik ingress path, ensuring consistent routing and TLS termination.</p>
















<h2 id="infrastructure">Infrastructure</h2>
<p>The cluster runs on two nodes:</p>
<ul>
<li><strong>Node 1</strong> (192.168.0.200): Control plane + worker node</li>
<li><strong>Node 2</strong> (192.168.0.201): Worker node</li>
</ul>
<p>Storage is provided by <strong>Longhorn</strong>, which provides distributed persistent volumes across both nodes for applications that require data persistence.</p>

            
        </main>
    

    



    
    



</article>

                




<footer id="site-footer">
    
    
    
</footer>

            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

    








    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
        
    

    

    
        
    

    

    

    

    
        
    

    
        
    

    

    

    

    
        
    

    

    
        
    

    
        
    

    

    
        
    

    
        
    

    

    
        
    

    
        <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","abstract":"This post explains how I remotely access my Kubernetes homelab cluster through a secure architecture using Traefik, MetalLB, and cert-manager.\nArchitecture Overview Traffic Flow All external traffic follows the same path through the ingress layer:\nInternet → Router: All requests (HTTP/HTTPS on 80/443 and Headscale DERP on 3478) arrive at the home router\nRouter → MetalLB: Port forwarding sends all traffic to the MetalLB virtual IP (192.168.0.220)\nMetalLB → Traefik: MetalLB load balancer distributes traffic to Traefik service across both cluster nodes","articleSection":"Posts","dateCreated":"2025-12-05T00:00:00Z","dateModified":"2025-12-05T00:00:00Z","headline":"Homelab Remote Access Architecture","inLanguage":"en-us","keywords":"Architecture, Homelab, Kubernetes, Traefik","name":"Homelab Remote Access Architecture","timeRequired":"PT2M","url":"http://localhost:1313/posts/homelab-remote-access-architecture/","wordCount":251}</script>
    


    <noscript>JavaScript is required</noscript>

    






<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
<script src="/js/toc.js"></script>



<script src="/js/copy-code.js"></script>




<script src="https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.min.js"></script>
<script>
  mermaid.initialize({
    startOnLoad: true,
    theme: 'base',
    securityLevel: 'loose',
    flowchart: {
      useMaxWidth: true,
      htmlLabels: true,
      curve: 'basis'
    }
  });

  
  document.addEventListener('DOMContentLoaded', function() {
    
    setTimeout(function() {
      const mermaidContainers = document.querySelectorAll('.mermaid');
      mermaidContainers.forEach(container => {
        const svg = container.querySelector('svg');
        if (svg) {
          
          const nodes = svg.querySelectorAll('g[data-id] rect');
          nodes.forEach(rect => {
            const originalFill = rect.getAttribute('fill');
            if (originalFill && originalFill !== 'transparent') {
              
              const brighterColor = brightenColor(originalFill);
              rect.style.transition = 'fill 0.2s ease';
              rect.addEventListener('mouseenter', function() {
                this.setAttribute('fill', brighterColor);
              });
              rect.addEventListener('mouseleave', function() {
                this.setAttribute('fill', originalFill);
              });
            }
          });
        }
      });
    }, 1000);
  });

  function brightenColor(color) {
    
    if (color.startsWith('#')) {
      const r = parseInt(color.slice(1, 3), 16);
      const g = parseInt(color.slice(3, 5), 16);
      const b = parseInt(color.slice(5, 7), 16);

      
      const newR = Math.min(255, Math.floor(r * 1.2));
      const newG = Math.min(255, Math.floor(g * 1.2));
      const newB = Math.min(255, Math.floor(b * 1.2));

      return `#${newR.toString(16).padStart(2, '0')}${newG.toString(16).padStart(2, '0')}${newB.toString(16).padStart(2, '0')}`;
    }
    return color;
  }
</script>



</body>
</html>
